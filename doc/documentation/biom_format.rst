.. _biom_format:

===========================================
BIological Observation Matrix (biom) format
===========================================


Motivation for changing the OTU Table Format
=============================================

As of QIIME 1.4.0-dev, OTU tables are represented in the newly developed biom format: a JSON-derived format rather than the previous tab-separated format. This change was made for several reasons: first, to facilitate efficient handling and storing of very large OTU tables; second, to support encapsulation of core study data (OTU table data and sample/OTU metadata) in a single file; and third, to facilitate the use of these tables between tools that support this format (e.g., passing of data between QIIME and MG-RAST).


Efficient handling and storage of very large OTU tables
-------------------------------------------------------

Presently we're hitting limitations with OTU table objects when working with thousands of samples and hundreds of thousands of OTUs. In the near future we expect that we'll be dealing with hundreds of thousands of samples in single analyses.

The OTU table format up to QIIME 1.3.0 involved a dense matrix: if an OTU was not observed in a given sample, that would be indicated with a zero. We now primarily represent OTU tables in a sparse format: if an OTU is not observed in a sample, there is no count for that OTU. The two ways of representing this data are exemplified here. 

Dense OTU table:: 

   OTU ID PC.354  PC.355  PC.356  
   OTU0   0   9   4
   OTU1   6   0   2
   OTU2   1   1   7
   OTU3   0   0   3

Sparse OTU table::

    PC.354 OTU1 6
    PC.354 OTU2 1
    PC.355 OTU0 9
    PC.355 OTU2 1
    PC.356 OTU0 4
    PC.356 OTU1 2
    PC.356 OTU2 7
    PC.356 OTU3 3

OTU table data tends to be sparse (i.e., a lot of counts are zeros) in which case the latter format is more convenient to work with. Both of these representations are now supported in QIIME via the dense and sparse formats, and in both cases a new file format has been defined.

Encapsulation of core study data (OTU table data and sample/OTU metadata) in a single file
------------------------------------------------------------------------------------------

The JSON-format OTU table allow for storage of arbitrary amounts of sample and OTU metadata in a single file. Sample metadata corresponds to what is generally found in QIIME mapping files. At this stage inclusion of this information in the OTU table file is optional, but it may be useful for sharing these files with other QIIME users and for publishing or archiving results of analyses. OTU metadata (generally a taxonomic assignment for an OTU) is also optional. In contrast to the previous OTU table format, you can now store more than one OTU metadata value in this field, so for example you can score taxonomic assignments based on two different taxonomic assignment approaches.

Facilitating the use of tables between tools that support this format
---------------------------------------------------------------------

Different tools, such as QIIME and MG-RAST, work with similar data structures that represent different types of data. An example of this is a `metagenome` table that could be generated by MG-RAST (where for example, columns are metagenomes and rows are functional categories). Exporting this data from MG-RAST in a suitable format will allow for the application of many of the QIIME tools to this data (such as generation of alpha rarefaction plots or beta diversity ordination plots). This new format is far more general than previous formats, so will support adoption by groups working with different data types and is already being integrated to support transfer of data between QIIME and MG-RAST.

