<!DOCTYPE html>
<!-- saved from url=(0098)https://ec2-184-73-146-205.compute-1.amazonaws.com:8888/07b7bf5f-ac30-4c74-9f4e-fa3d9b40d51f/print -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>IPython Notebook</title>
<link rel="stylesheet" href="./VariableRegionPositionBoundaries_files/jquery-ui.min.css" type="text/css">
<link rel="stylesheet" href="./VariableRegionPositionBoundaries_files/boilerplate.css" type="text/css">
<link rel="stylesheet" href="./VariableRegionPositionBoundaries_files/fbm.css" type="text/css">
<link rel="stylesheet" href="./VariableRegionPositionBoundaries_files/page.css" type="text/css">


<script type="text/javascript" src="./VariableRegionPositionBoundaries_files/MathJax.js" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/static/mathjax/MathJax.js";
</script>
<link rel="stylesheet" href="./VariableRegionPositionBoundaries_files/codemirror.css?v=63efb">
<link rel="stylesheet" href="./VariableRegionPositionBoundaries_files/ipython.css?v=fa49d">
<link rel="stylesheet" href="./VariableRegionPositionBoundaries_files/prettify.css?v=83f40">
<link rel="stylesheet" href="./VariableRegionPositionBoundaries_files/notebook.css" type="text/css">
<link rel="stylesheet" href="./VariableRegionPositionBoundaries_files/printnotebook.css" type="text/css">
<link rel="stylesheet" href="./VariableRegionPositionBoundaries_files/renderedhtml.css" type="text/css">



<style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-family: serif; font-size: 85%; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuTitle {background-color: #CCCCCC; margin: -5px 0 0 0; text-align: center; font-style: italic; font-size: 80%; color: #444444; padding: 2px 0; overflow: hidden}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
</style><style type="text/css">#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style></head>
<body data-project="/home/sgeadmin" data-base-project-url="/" data-base-kernel-url="/" data-read-only="False" data-notebook-id="07b7bf5f-ac30-4c74-9f4e-fa3d9b40d51f">
<div id="header" class="border-box-sizing ui-widget ui-widget-content" style="border-top-style: none; border-left-style: none; border-right-style: none; ">
<span id="ipython_notebook"><h1><a href="https://ec2-184-73-146-205.compute-1.amazonaws.com:8888/" alt="dashboard"><img src="./VariableRegionPositionBoundaries_files/ipynblogo.png" alt="IPython Notebook"></a></h1></span>

<span id="login_widget">

<button id="logout" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Logout</span></button>

</span>



</div>
<div id="site" class="border-box-sizing" style="display: block; ">

<div id="main_app" class="border-box-sizing ui-widget">
<div id="notebook_panel" class="border-box-sizing ui-widget">
<div id="notebook" class="border-box-sizing"><div class="cell text_cell border-box-sizing ui-widget-content ui-corner-all" tabindex="2"><div class="text_cell_input border-box-sizing" style="display: none; "><div class="CodeMirror CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-default" tabindex="-1"><div style="position: relative"><div style="position: relative"><div class="CodeMirror-gutter" style="display: none; "><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0; outline-style: none; outline-width: initial; outline-color: initial; "><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden; outline: 5px auto none"><pre><span>x</span></pre></div><pre class="CodeMirror-cursor">&nbsp;</pre><div style="position: relative; z-index: -1"></div><div></div></div></div></div></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h2>This notebook is intended to calculate the positions of primers in an alignment, using functions from PrimerProspector.</h2></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="text_cell_input border-box-sizing" style="display: none; "><div class="CodeMirror CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-default" tabindex="-1"><div style="position: relative"><div style="position: relative"><div class="CodeMirror-gutter" style="display: none; "><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0; outline-style: none; outline-width: initial; outline-color: initial; "><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden; outline: 5px auto none"><pre><span>x</span></pre></div><pre class="CodeMirror-cursor">&nbsp;</pre><div style="position: relative; z-index: -1"></div><div></div></div></div></div></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h3>Import the needed functions, and define the primer sequences</h3></div></div><div class="cell border-box-sizing code_cell vbox" tabindex="2"><div class="input hbox"><div class="prompt input_prompt">In&nbsp;[6]:</div><div class="input_area box-flex1"><div class="CodeMirror"><div style="overflow-x: hidden; overflow-y: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 5px; "><textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-ipython" tabindex="-1"><div style="position: relative; height: 707px; "><div style="position: relative; top: 0px; "><div class="CodeMirror-gutter" style="display: none; "><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0; outline-style: none; outline-width: initial; outline-color: initial; "><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden; outline: 5px auto none"></div><pre class="CodeMirror-cursor" style="top: 0px; left: 0px; ">&nbsp;</pre><div style="position: relative; z-index: -1; display: none; "></div><div style=""><pre><span class="cm-comment"># Code modified from PrimerProspector library slice_aligned_region.py (development version)</span></pre><pre> </pre><pre><span class="cm-comment"># Imports and definitions</span></pre><pre><span class="cm-keyword">from</span> <span class="cm-variable">string</span> <span class="cm-keyword">import</span> <span class="cm-variable">lower</span>, <span class="cm-variable">upper</span></pre><pre><span class="cm-keyword">from</span> <span class="cm-variable">operator</span> <span class="cm-keyword">import</span> <span class="cm-variable">itemgetter</span></pre><pre> </pre><pre><span class="cm-keyword">from</span> <span class="cm-variable">cogent</span> <span class="cm-keyword">import</span> <span class="cm-variable">LoadSeqs</span>, <span class="cm-variable">DNA</span></pre><pre><span class="cm-keyword">from</span> <span class="cm-variable">cogent.core.alphabet</span> <span class="cm-keyword">import</span> <span class="cm-variable">AlphabetError</span></pre><pre><span class="cm-keyword">from</span> <span class="cm-variable">cogent.align.align</span> <span class="cm-keyword">import</span> <span class="cm-variable">make_dna_scoring_dict</span>, <span class="cm-variable">local_pairwise</span></pre><pre><span class="cm-keyword">from</span> <span class="cm-variable">cogent.parse.fasta</span> <span class="cm-keyword">import</span> <span class="cm-variable">MinimalFastaParser</span></pre><pre><span class="cm-keyword">from</span> <span class="cm-variable">cogent.core.moltype</span> <span class="cm-keyword">import</span> <span class="cm-variable">IUPAC_DNA_ambiguities</span></pre><pre> </pre><pre><span class="cm-variable">DNA_CODES</span> = [<span class="cm-string">'A'</span>, <span class="cm-string">'C'</span>, <span class="cm-string">'T'</span>, <span class="cm-string">'G'</span>, <span class="cm-string">'R'</span>, <span class="cm-string">'Y'</span>, <span class="cm-string">'M'</span>, <span class="cm-string">'K'</span>,</pre><pre> <span class="cm-string">'W'</span>, <span class="cm-string">'S'</span>, <span class="cm-string">'B'</span>, <span class="cm-string">'D'</span>, <span class="cm-string">'H'</span>, <span class="cm-string">'V'</span>, <span class="cm-string">'N'</span>]</pre><pre> </pre><pre> </pre><pre><span class="cm-comment"># Note that these are all written 5'-&gt;3', the reverse primers are reverse complemented for the local alignment</span></pre><pre> </pre><pre><span class="cm-comment"># If one wanted to test different primers, they would be defined here.</span></pre><pre> </pre><pre><span class="cm-comment"># 27f/338r = V2 (also includes V1, but generally just referred to as V2)</span></pre><pre><span class="cm-comment"># 349f/534r = V3</span></pre><pre><span class="cm-comment"># 515f/806r = V4</span></pre><pre><span class="cm-comment"># 967f/1046r = V6</span></pre><pre><span class="cm-comment"># 1391f/1492r = V9</span></pre><pre> </pre><pre><span class="cm-variable">primer_seqs</span> = {</pre><pre>           <span class="cm-string">'27f'</span>:<span class="cm-string">'AGAGTTTGATCMTGGCTCAG'</span>,</pre><pre>           <span class="cm-string">'338r'</span>:<span class="cm-variable">DNA.rc</span>(<span class="cm-string">'GCTGCCTCCCGTAGGAGT'</span>),</pre><pre>           <span class="cm-string">'349f'</span>:<span class="cm-string">'GYGCASCAGKCGMGAAW'</span>,</pre><pre>           <span class="cm-string">'534r'</span>:<span class="cm-variable">DNA.rc</span>(<span class="cm-string">'ATTACCGCGGCTGCTGG'</span>),</pre><pre>           <span class="cm-string">'515f'</span>:<span class="cm-string">'GTGCCAGCMGCCGCGGTAA'</span>,</pre><pre>           <span class="cm-string">'806r'</span>:<span class="cm-variable">DNA.rc</span>(<span class="cm-string">'GGACTACVSGGGTATCTAAT'</span>),</pre><pre>           <span class="cm-string">'967f'</span>:<span class="cm-string">'CAACGCGAAGAACCTTACC'</span>,</pre><pre>           <span class="cm-string">'1048r'</span>:<span class="cm-variable">DNA.rc</span>(<span class="cm-string">'CGRCRGCCATGYACCWC'</span>),</pre><pre>           <span class="cm-string">'1391f'</span>:<span class="cm-string">'TGYACACACCGCCCGTC'</span>,</pre><pre>           <span class="cm-string">'1492r'</span>:<span class="cm-variable">DNA.rc</span>(<span class="cm-string">'GGCTACCTTGTTACGACTT'</span>),</pre><pre>           <span class="cm-string">'1391r'</span>:<span class="cm-string">'TGYACACACCGCCCGTC'</span> <span class="cm-comment"># Need this rather than forward primer to get proper 3' position of reverse version</span></pre><pre>           }</pre><pre> </pre><pre><span class="cm-variable">reference_aligned_file</span> = <span class="cm-string">'/software/gg_otus-4feb2011-release/rep_set/gg_76_otus_4feb2011_aligned.fasta'</span></pre></div></div></div></div></div></div></div></div></div><div class="output vbox" style=""></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="text_cell_input border-box-sizing" style="display: none; "><div class="CodeMirror CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-default" tabindex="-1"><div style="position: relative"><div style="position: relative"><div class="CodeMirror-gutter" style="display: none; "><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0; outline-style: none; outline-width: initial; outline-color: initial; "><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden; outline: 5px auto none"><pre><span>x</span></pre></div><pre class="CodeMirror-cursor">&nbsp;</pre><div style="position: relative; z-index: -1"></div><div></div></div></div></div></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h3>Functions from the PrimerProspector code are here.  Should only be calling get_primer_indices_counts and get_final_indices directly to get aligned indices.  Takes a while to run, as this has to do many local alignments for each primer (and takes the mode of the index in the alignment as the most accurate aligned index).</h3></div></div><div class="cell border-box-sizing code_cell vbox" tabindex="2"><div class="input hbox"><div class="prompt input_prompt">In&nbsp;[7]:</div><div class="input_area box-flex1"><div class="CodeMirror"><div style="overflow-x: hidden; overflow-y: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 5px; "><textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-ipython" tabindex="-1"><div style="position: relative; height: 4481px; width: 1045px; "><div style="position: relative; top: 0px; "><div class="CodeMirror-gutter" style="display: none; "><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0; outline-style: none; outline-width: initial; outline-color: initial; width: 1040px; "><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden; outline: 5px auto none"></div><pre class="CodeMirror-cursor" style="top: 0px; left: 0px; ">&nbsp;</pre><div style="position: relative; z-index: -1; display: none; "></div><div style=""><pre> </pre><pre><span class="cm-comment"># Begin functions</span></pre><pre> </pre><pre><span class="cm-string">""" This library was written for the purpose of slicing out a region of a reference sequence set to </span></pre><pre><span class="cm-string">match a target region amplified by a set of primers to improve taxonomic classification as seen in</span></pre><pre><span class="cm-string">Werner et al.  It has been modified here to simply return the positions (3' end of the primer) in the</span></pre><pre><span class="cm-string">alignment of the given primer pair, as well as the position of simulated short reads of 150, 250, and</span></pre><pre><span class="cm-string">400 base pairs.  Note that some of these reads are larger than the size of the amplicon itself, and in</span></pre><pre><span class="cm-string">this case the simulated read simply isn't created."""</span></pre><pre> </pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">match_scorer_ambigs</span>(<span class="cm-variable">match</span>=<span class="cm-number">1</span>,</pre><pre>                       <span class="cm-variable">mismatch</span>=<span class="cm-operator">-</span><span class="cm-number">1</span>,</pre><pre>                       <span class="cm-variable">matches</span>=<span class="cm-builtin">None</span>):</pre><pre>    <span class="cm-string">""" Alternative scorer factory for sw_align, allows match to ambiguous chars</span></pre><pre> </pre><pre><span class="cm-string">    It allows for matching to ambiguous characters which is useful for </span></pre><pre><span class="cm-string">     primer/sequence matching. Not sure what should happen with gaps, but they</span></pre><pre><span class="cm-string">     shouldn't be passed to this function anyway. Currently a gap will only match</span></pre><pre><span class="cm-string">     a gap.</span></pre><pre> </pre><pre><span class="cm-string">    match and mismatch should both be numbers. Typically, match should be </span></pre><pre><span class="cm-string">    positive and mismatch should be negative.</span></pre><pre> </pre><pre><span class="cm-string">    Resulting function has signature f(x,y) -&gt; number.</span></pre><pre><span class="cm-string">    </span></pre><pre><span class="cm-string">    match: score for nucleotide match</span></pre><pre><span class="cm-string">    mismatch: score for nucleotide mismatch</span></pre><pre><span class="cm-string">    matches: dictionary for matching nucleotides, including degenerate bases</span></pre><pre><span class="cm-string">    """</span></pre><pre>    </pre><pre>    <span class="cm-variable">matches</span> = <span class="cm-variable">matches</span> <span class="cm-operator">or</span> <span class="cm-error">\</span></pre><pre>     {<span class="cm-string">'A'</span>:{<span class="cm-string">'A'</span>:<span class="cm-builtin">None</span>},<span class="cm-string">'G'</span>:{<span class="cm-string">'G'</span>:<span class="cm-builtin">None</span>},<span class="cm-string">'C'</span>:{<span class="cm-string">'C'</span>:<span class="cm-builtin">None</span>},<span class="cm-error">\</span></pre><pre>      <span class="cm-string">'T'</span>:{<span class="cm-string">'T'</span>:<span class="cm-builtin">None</span>},<span class="cm-string">'-'</span>:{<span class="cm-string">'-'</span>:<span class="cm-builtin">None</span>}}</pre><pre>    <span class="cm-keyword">for</span> <span class="cm-variable">ambig</span>, <span class="cm-variable">chars</span> <span class="cm-operator">in</span> <span class="cm-variable">IUPAC_DNA_ambiguities.items</span>():</pre><pre>        <span class="cm-keyword">try</span>:</pre><pre>            <span class="cm-variable">matches</span>[<span class="cm-variable">ambig</span>]<span class="cm-variable">.update</span>({}<span class="cm-variable">.fromkeys</span>(<span class="cm-variable">chars</span>))</pre><pre>        <span class="cm-keyword">except</span> <span class="cm-variable">KeyError</span>:</pre><pre>            <span class="cm-variable">matches</span>[<span class="cm-variable">ambig</span>] = {}<span class="cm-variable">.fromkeys</span>(<span class="cm-variable">chars</span>)</pre><pre>        </pre><pre>        <span class="cm-keyword">for</span> <span class="cm-variable">char</span> <span class="cm-operator">in</span> <span class="cm-variable">chars</span>:</pre><pre>            <span class="cm-keyword">try</span>:</pre><pre>                <span class="cm-variable">matches</span>[<span class="cm-variable">char</span>]<span class="cm-variable">.update</span>({<span class="cm-variable">ambig</span>:<span class="cm-builtin">None</span>})</pre><pre>            <span class="cm-keyword">except</span> <span class="cm-variable">KeyError</span>:</pre><pre>                <span class="cm-variable">matches</span>[<span class="cm-variable">char</span>] = {<span class="cm-variable">ambig</span>:<span class="cm-builtin">None</span>}</pre><pre>            </pre><pre>    <span class="cm-keyword">def</span> <span class="cm-variable">scorer</span>(<span class="cm-variable">x</span>, <span class="cm-variable">y</span>):</pre><pre>        <span class="cm-comment"># need a better way to disallow unknown characters (could</span></pre><pre>        <span class="cm-comment"># try/except for a KeyError on the next step, but that would only </span></pre><pre>        <span class="cm-comment"># test one of the characters)</span></pre><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">x</span> <span class="cm-operator">not</span> <span class="cm-operator">in</span> <span class="cm-variable">matches</span> <span class="cm-operator">or</span> <span class="cm-variable">y</span> <span class="cm-operator">not</span> <span class="cm-operator">in</span> <span class="cm-variable">matches</span>:</pre><pre>            <span class="cm-keyword">raise</span> <span class="cm-variable">ValueError</span>, <span class="cm-string">"Unknown character: %s or %s"</span> <span class="cm-operator">%</span> (<span class="cm-variable">x</span>,<span class="cm-variable">y</span>)</pre><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">y</span> <span class="cm-operator">in</span> <span class="cm-variable">matches</span>[<span class="cm-variable">x</span>]:</pre><pre>            <span class="cm-keyword">return</span> <span class="cm-variable">match</span></pre><pre>        <span class="cm-keyword">else</span>:</pre><pre>            <span class="cm-keyword">return</span> <span class="cm-variable">mismatch</span></pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable">scorer</span></pre><pre> </pre><pre> </pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">get_primer_mismatches</span>(<span class="cm-variable">primer_hit</span>,</pre><pre>                          <span class="cm-variable">target_hit</span>,</pre><pre>                          <span class="cm-variable">sw_scorer</span>=<span class="cm-variable">match_scorer_ambigs</span>(<span class="cm-number">1</span>, <span class="cm-operator">-</span><span class="cm-number">1</span>)):</pre><pre>    <span class="cm-string">""" Gets mismatches for a given primer sequence and target hit</span></pre><pre><span class="cm-string">    </span></pre><pre><span class="cm-string">    Specifically this returns total mismatches</span></pre><pre><span class="cm-string">    </span></pre><pre><span class="cm-string">    primer_hit: Alignment object for primer, normally matches primer unless</span></pre><pre><span class="cm-string">     gaps were used in the alignment</span></pre><pre><span class="cm-string">    target_hit: Alignment object for segment of sequence where primer was</span></pre><pre><span class="cm-string">     aligned to.  Can contain gaps.</span></pre><pre><span class="cm-string">    sw_scorer: Gives scores for mismatches, gap insertions in alignment.</span></pre><pre><span class="cm-string">    </span></pre><pre><span class="cm-string">    """</span></pre><pre> </pre><pre>    <span class="cm-comment"># Sum mismatches</span></pre><pre>    <span class="cm-variable">mismatches</span> = <span class="cm-number">0</span></pre><pre>    <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-operator">in</span> <span class="cm-builtin">range</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">primer_hit</span>)):</pre><pre>        <span class="cm-comment"># using the scoring function to check for</span></pre><pre>        <span class="cm-comment"># matches, but might want to just access the dict</span></pre><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">sw_scorer</span>(<span class="cm-variable">target_hit</span>[<span class="cm-variable">i</span>], <span class="cm-variable">primer_hit</span>[<span class="cm-variable">i</span>]) <span class="cm-operator">==</span> <span class="cm-operator">-</span><span class="cm-number">1</span>: </pre><pre>            <span class="cm-variable">mismatches</span> += <span class="cm-number">1</span></pre><pre>            </pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable">mismatches</span></pre><pre> </pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">get_aligned_pos</span>(<span class="cm-variable">unaligned_index</span>, <span class="cm-variable">aligned_seq</span>):</pre><pre>    <span class="cm-string">""" Returns aligned index given index in degapped sequence</span></pre><pre><span class="cm-string">    </span></pre><pre><span class="cm-string">    unaligned_index: int with index in unaligned sequence</span></pre><pre><span class="cm-string">    aligned_seq: aligned sequence to find index"""</span></pre><pre>    </pre><pre>    <span class="cm-variable">nt_counter</span> = <span class="cm-number">0</span></pre><pre>    <span class="cm-variable">total_counter</span> = <span class="cm-number">0</span></pre><pre>    </pre><pre>    <span class="cm-keyword">for</span> <span class="cm-variable">nt</span> <span class="cm-operator">in</span> <span class="cm-variable">aligned_seq</span>:</pre><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">nt</span> <span class="cm-operator">in</span> <span class="cm-variable">DNA_CODES</span>:</pre><pre>            <span class="cm-variable">nt_counter</span> += <span class="cm-number">1</span></pre><pre>        <span class="cm-variable">total_counter</span> += <span class="cm-number">1</span></pre><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">nt_counter</span> <span class="cm-operator">==</span> <span class="cm-variable">unaligned_index</span>:</pre><pre>            <span class="cm-keyword">break</span></pre><pre>            </pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable">total_counter</span></pre><pre> </pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">pair_hmm_align_unaligned_seqs</span>(<span class="cm-variable">seqs</span>,</pre><pre>                                  <span class="cm-variable">moltype</span>=<span class="cm-variable">DNA</span>,</pre><pre>                                  <span class="cm-variable">params</span>={}):</pre><pre>    <span class="cm-string">"""</span></pre><pre><span class="cm-string">        Handles pairwise alignment of given sequence pair</span></pre><pre><span class="cm-string">        </span></pre><pre><span class="cm-string">        seqs: list of [primer, target sequence] in string format</span></pre><pre><span class="cm-string">        moltype: molecule type tested.  Only DNA supported.</span></pre><pre><span class="cm-string">        params: Used to set parameters for opening, extending gaps  and score</span></pre><pre><span class="cm-string">         matrix if something other than the default given in this function </span></pre><pre><span class="cm-string">         is desired.</span></pre><pre><span class="cm-string">    """</span></pre><pre>    </pre><pre>    <span class="cm-variable">seqs</span> = <span class="cm-variable">LoadSeqs</span>(<span class="cm-variable">data</span>=<span class="cm-variable">seqs</span>,<span class="cm-variable">moltype</span>=<span class="cm-variable">moltype</span>,<span class="cm-variable">aligned</span>=<span class="cm-builtin">False</span>)</pre><pre>    <span class="cm-keyword">try</span>:</pre><pre>        <span class="cm-variable">s1</span>, <span class="cm-variable">s2</span> = <span class="cm-variable">seqs.values</span>()</pre><pre>    <span class="cm-keyword">except</span> <span class="cm-variable">ValueError</span>:</pre><pre>        <span class="cm-keyword">raise</span> <span class="cm-variable">ValueError</span>,<span class="cm-error">\</span></pre><pre>         <span class="cm-string">"Pairwise aligning of seqs requires exactly two seqs."</span></pre><pre>    </pre><pre>    <span class="cm-keyword">try</span>:</pre><pre>        <span class="cm-variable">gap_open</span> = <span class="cm-variable">params</span>[<span class="cm-string">'gap_open'</span>]</pre><pre>    <span class="cm-keyword">except</span> <span class="cm-variable">KeyError</span>:</pre><pre>        <span class="cm-variable">gap_open</span> = <span class="cm-number">5</span></pre><pre>    <span class="cm-keyword">try</span>:</pre><pre>        <span class="cm-variable">gap_extend</span> = <span class="cm-variable">params</span>[<span class="cm-string">'gap_extend'</span>]</pre><pre>    <span class="cm-keyword">except</span> <span class="cm-variable">KeyError</span>:</pre><pre>        <span class="cm-variable">gap_extend</span> = <span class="cm-number">2</span></pre><pre>    <span class="cm-keyword">try</span>:</pre><pre>        <span class="cm-variable">score_matrix</span> = <span class="cm-variable">params</span>[<span class="cm-string">'score_matrix'</span>]</pre><pre>    <span class="cm-keyword">except</span> <span class="cm-variable">KeyError</span>:</pre><pre>        <span class="cm-variable">score_matrix</span> = <span class="cm-variable">make_dna_scoring_dict</span>(<span class="cm-error">\</span></pre><pre>         <span class="cm-variable">match</span>=<span class="cm-number">1</span>, <span class="cm-variable">transition</span>=<span class="cm-operator">-</span><span class="cm-number">1</span>, <span class="cm-variable">transversion</span>=<span class="cm-operator">-</span><span class="cm-number">1</span>)</pre><pre>    </pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable">local_pairwise</span>(<span class="cm-variable">s1</span>, <span class="cm-variable">s2</span>, <span class="cm-variable">score_matrix</span>, <span class="cm-variable">gap_open</span>, <span class="cm-variable">gap_extend</span>)</pre><pre> </pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">local_align_primer_seq</span>(<span class="cm-variable">primer</span>,</pre><pre>                           <span class="cm-variable">sequence</span>):</pre><pre>    <span class="cm-string">"""Perform local alignment of primer and sequence</span></pre><pre><span class="cm-string">    </span></pre><pre><span class="cm-string">        primer: Current primer being tested</span></pre><pre><span class="cm-string">        sequence: Current sequence</span></pre><pre><span class="cm-string">        </span></pre><pre><span class="cm-string">        Returns the Alignment object primer sequence and target sequence, </span></pre><pre><span class="cm-string">         and the start position in sequence of the hit.</span></pre><pre><span class="cm-string">    """</span></pre><pre> </pre><pre> </pre><pre>    <span class="cm-variable">query_sequence</span> = <span class="cm-variable">sequence</span></pre><pre>     </pre><pre>    <span class="cm-comment"># Get alignment object from primer, target sequence</span></pre><pre>    <span class="cm-variable">alignment</span> = <span class="cm-variable">pair_hmm_align_unaligned_seqs</span>([<span class="cm-variable">primer</span>,<span class="cm-variable">query_sequence</span>])</pre><pre> </pre><pre>    <span class="cm-comment"># Extract sequence of primer, target site, may have gaps in insertions</span></pre><pre>    <span class="cm-comment"># or deletions have occurred.</span></pre><pre>    <span class="cm-variable">primer_hit</span> = <span class="cm-builtin">str</span>(<span class="cm-variable">alignment.Seqs</span>[<span class="cm-number">0</span>])</pre><pre>    <span class="cm-variable">target_hit</span> = <span class="cm-builtin">str</span>(<span class="cm-variable">alignment.Seqs</span>[<span class="cm-number">1</span>])</pre><pre>    </pre><pre>    <span class="cm-comment"># Get index of primer hit in target sequence.</span></pre><pre>    <span class="cm-keyword">try</span>:</pre><pre>        <span class="cm-variable">hit_start</span> = <span class="cm-variable">query_sequence.index</span>(<span class="cm-variable">target_hit.replace</span>(<span class="cm-string">'-'</span>,<span class="cm-string">''</span>))</pre><pre>    <span class="cm-keyword">except</span> <span class="cm-variable">ValueError</span>:</pre><pre>        <span class="cm-keyword">raise</span> <span class="cm-variable">ValueError</span>,(<span class="cm-string">'substring not found, query string %s, target_hit %s'</span><span class="cm-error">\</span></pre><pre>         <span class="cm-operator">%</span> (<span class="cm-variable">query_sequence</span>, <span class="cm-variable">target_hit</span>))</pre><pre>         </pre><pre>    </pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable">primer_hit</span>, <span class="cm-variable">target_hit</span>, <span class="cm-variable">hit_start</span></pre><pre> </pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">get_primer_indices_counts</span>(<span class="cm-variable">curr_fasta</span>,</pre><pre>                              <span class="cm-variable">f_primer_seq</span>,</pre><pre>                              <span class="cm-variable">r_primer_seq</span>,</pre><pre>                              <span class="cm-variable">mismatch_threshold</span>=<span class="cm-number">3</span>):</pre><pre>    <span class="cm-string">""" Gets counts of primer hit indices for forward and reverse primer</span></pre><pre><span class="cm-string">    </span></pre><pre><span class="cm-string">    curr_fasta:  current aligned fasta filepath</span></pre><pre><span class="cm-string">    f_primer_seq: forward primer sequence</span></pre><pre><span class="cm-string">    r_primer_seq: reverse primer sequence (already reverse complemented)</span></pre><pre><span class="cm-string">    mismatch_threshold: used to determine which primer hits are counted for</span></pre><pre><span class="cm-string">     getting the final aligned index"""</span></pre><pre>    </pre><pre>    <span class="cm-variable">f_primer_indices</span> = {}</pre><pre>    <span class="cm-variable">r_primer_indices</span> = {}</pre><pre>    </pre><pre>    <span class="cm-keyword">for</span> <span class="cm-variable">label</span>, <span class="cm-variable">seq</span> <span class="cm-operator">in</span> <span class="cm-variable">MinimalFastaParser</span>(<span class="cm-builtin">open</span>(<span class="cm-variable">curr_fasta</span>), <span class="cm-string">"U"</span>):</pre><pre>            </pre><pre>            <span class="cm-variable">unaligned_seq</span> = <span class="cm-variable">upper</span>(<span class="cm-variable">seq.replace</span>(<span class="cm-string">"."</span>,<span class="cm-string">""</span>)<span class="cm-variable">.replace</span>(<span class="cm-string">"-"</span>,<span class="cm-string">""</span>))</pre><pre>            </pre><pre>            <span class="cm-variable">primer_hit</span>, <span class="cm-variable">target_hit</span>, <span class="cm-variable">hit_start</span> = <span class="cm-error">\</span></pre><pre>             <span class="cm-variable">local_align_primer_seq</span>(<span class="cm-variable">f_primer_seq</span>, <span class="cm-variable">unaligned_seq</span>)</pre><pre><span class="cm-error">             </span></pre><pre>            <span class="cm-comment"># get mismatches</span></pre><pre>            <span class="cm-variable">mismatches</span> = <span class="cm-variable">get_primer_mismatches</span>(<span class="cm-variable">primer_hit</span>, <span class="cm-variable">target_hit</span>)</pre><pre>            </pre><pre>            <span class="cm-keyword">if</span> <span class="cm-variable">mismatches</span> <span class="cm-operator">&lt;=</span> <span class="cm-variable">mismatch_threshold</span>:</pre><pre>                <span class="cm-comment"># Correction for forward primer to get 3' position</span></pre><pre>                <span class="cm-variable">aligned_pos</span> = <span class="cm-variable">get_aligned_pos</span>(<span class="cm-variable">hit_start</span> <span class="cm-operator">+</span> <span class="cm-builtin">len</span>(<span class="cm-variable">target_hit</span>), <span class="cm-variable">seq</span>)</pre><pre>                </pre><pre>                <span class="cm-keyword">try</span>:</pre><pre>                    <span class="cm-variable">f_primer_indices</span>[<span class="cm-variable">aligned_pos</span>] += <span class="cm-number">1</span></pre><pre>                <span class="cm-keyword">except</span> <span class="cm-variable">KeyError</span>:</pre><pre>                    <span class="cm-variable">f_primer_indices</span>[<span class="cm-variable">aligned_pos</span>] = <span class="cm-number">0</span></pre><pre>            </pre><pre>            <span class="cm-variable">primer_hit</span>, <span class="cm-variable">target_hit</span>, <span class="cm-variable">hit_start</span> = <span class="cm-error">\</span></pre><pre>             <span class="cm-variable">local_align_primer_seq</span>(<span class="cm-variable">r_primer_seq</span>, <span class="cm-variable">unaligned_seq</span>)</pre><pre><span class="cm-error">             </span></pre><pre>            <span class="cm-comment"># get mismatches</span></pre><pre>            <span class="cm-variable">mismatches</span> = <span class="cm-variable">get_primer_mismatches</span>(<span class="cm-variable">primer_hit</span>, <span class="cm-variable">target_hit</span>)</pre><pre>            </pre><pre>            <span class="cm-keyword">if</span> <span class="cm-variable">mismatches</span> <span class="cm-operator">&lt;=</span> <span class="cm-variable">mismatch_threshold</span>:</pre><pre>                <span class="cm-comment"># No correction for reverse primer hit</span></pre><pre>                <span class="cm-variable">aligned_pos</span> = <span class="cm-variable">get_aligned_pos</span>(<span class="cm-variable">hit_start</span>, <span class="cm-variable">seq</span>)</pre><pre>                </pre><pre>                <span class="cm-keyword">try</span>:</pre><pre>                    <span class="cm-variable">r_primer_indices</span>[<span class="cm-variable">aligned_pos</span>] += <span class="cm-number">1</span></pre><pre>                <span class="cm-keyword">except</span> <span class="cm-variable">KeyError</span>:</pre><pre>                    <span class="cm-variable">r_primer_indices</span>[<span class="cm-variable">aligned_pos</span>] = <span class="cm-number">0</span></pre><pre>                    </pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable">f_primer_indices</span>, <span class="cm-variable">r_primer_indices</span></pre><pre> </pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">get_final_indices</span>(<span class="cm-variable">f_primer_indices</span>,</pre><pre>                      <span class="cm-variable">r_primer_indices</span>):</pre><pre>    <span class="cm-string">""" Sorts, retrieves mode of aligning primer hits indices</span></pre><pre><span class="cm-string">    </span></pre><pre><span class="cm-string">    f_primer_indices:  dictionary of primer_indices:counts</span></pre><pre><span class="cm-string">    r_primer_indices:  dictionary of primer_indices:counts</span></pre><pre><span class="cm-string">    """</span></pre><pre>    </pre><pre>    <span class="cm-variable">f_primer_final</span> = []</pre><pre>    <span class="cm-variable">r_primer_final</span> = []</pre><pre>    </pre><pre>    <span class="cm-keyword">for</span> <span class="cm-variable">index</span> <span class="cm-operator">in</span> <span class="cm-variable">f_primer_indices</span>:</pre><pre>        <span class="cm-variable">f_primer_final.append</span>((<span class="cm-variable">index</span>, <span class="cm-variable">f_primer_indices</span>[<span class="cm-variable">index</span>]))</pre><pre>    <span class="cm-variable">f_primer_final.sort</span>(<span class="cm-variable">key</span>=<span class="cm-variable">itemgetter</span>(<span class="cm-number">1</span>), <span class="cm-variable">reverse</span>=<span class="cm-builtin">True</span>)</pre><pre>    <span class="cm-variable">f_primer_index</span> = <span class="cm-variable">f_primer_final</span>[<span class="cm-number">0</span>][<span class="cm-number">0</span>]</pre><pre> </pre><pre>    <span class="cm-keyword">for</span> <span class="cm-variable">index</span> <span class="cm-operator">in</span> <span class="cm-variable">r_primer_indices</span>:</pre><pre>        <span class="cm-variable">r_primer_final.append</span>((<span class="cm-variable">index</span>, <span class="cm-variable">r_primer_indices</span>[<span class="cm-variable">index</span>]))</pre><pre>    <span class="cm-variable">r_primer_final.sort</span>(<span class="cm-variable">key</span>=<span class="cm-variable">itemgetter</span>(<span class="cm-number">1</span>), <span class="cm-variable">reverse</span>=<span class="cm-builtin">True</span>)</pre><pre>    <span class="cm-variable">r_primer_index</span> = <span class="cm-variable">r_primer_final</span>[<span class="cm-number">0</span>][<span class="cm-number">0</span>]</pre><pre>    </pre><pre>    </pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable">f_primer_index</span>, <span class="cm-variable">r_primer_index</span></pre><pre> </pre><pre><span class="cm-variable">primer_indices</span> = {}</pre><pre> </pre><pre><span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span> = <span class="cm-variable">get_primer_indices_counts</span>(<span class="cm-variable">reference_aligned_file</span>, <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'27f'</span>], <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'338r'</span>])</pre><pre><span class="cm-variable">primer_indices</span>[<span class="cm-string">'27f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'338r'</span>] = <span class="cm-variable">get_final_indices</span>(<span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span>)</pre><pre> </pre><pre><span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span> = <span class="cm-variable">get_primer_indices_counts</span>(<span class="cm-variable">reference_aligned_file</span>, <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'349f'</span>], <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'534r'</span>])</pre><pre><span class="cm-variable">primer_indices</span>[<span class="cm-string">'349f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'534r'</span>] = <span class="cm-variable">get_final_indices</span>(<span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span>)</pre><pre> </pre><pre><span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span> = <span class="cm-variable">get_primer_indices_counts</span>(<span class="cm-variable">reference_aligned_file</span>, <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'515f'</span>], <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'806r'</span>])</pre><pre><span class="cm-variable">primer_indices</span>[<span class="cm-string">'515f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'806r'</span>] = <span class="cm-variable">get_final_indices</span>(<span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span>)</pre><pre> </pre><pre><span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span> = <span class="cm-variable">get_primer_indices_counts</span>(<span class="cm-variable">reference_aligned_file</span>, <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'967f'</span>], <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'1048r'</span>])</pre><pre><span class="cm-variable">primer_indices</span>[<span class="cm-string">'967f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1048r'</span>] = <span class="cm-variable">get_final_indices</span>(<span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span>)</pre><pre> </pre><pre><span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span> = <span class="cm-variable">get_primer_indices_counts</span>(<span class="cm-variable">reference_aligned_file</span>, <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'1391f'</span>], <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'1492r'</span>])</pre><pre><span class="cm-variable">primer_indices</span>[<span class="cm-string">'1391f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1492r'</span>] = <span class="cm-variable">get_final_indices</span>(<span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span>)</pre><pre> </pre><pre><span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span> = <span class="cm-variable">get_primer_indices_counts</span>(<span class="cm-variable">reference_aligned_file</span>, <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'515f'</span>], <span class="cm-variable">primer_seqs</span>[<span class="cm-string">'1391r'</span>])</pre><pre><span class="cm-variable">primer_indices</span>[<span class="cm-string">'515f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1391r'</span>] = <span class="cm-variable">get_final_indices</span>(<span class="cm-variable">primer_f_indices</span>, <span class="cm-variable">primer_r_indices</span>)</pre></div></div></div></div></div></div></div></div></div><div class="output vbox" style=""></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="text_cell_input border-box-sizing" style="display: none; "><div class="CodeMirror CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-default" tabindex="-1"><div style="position: relative"><div style="position: relative"><div class="CodeMirror-gutter" style="display: none; "><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0; outline-style: none; outline-width: initial; outline-color: initial; "><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden; outline: 5px auto none"><pre><span>x</span></pre></div><pre class="CodeMirror-cursor">&nbsp;</pre><div style="position: relative; z-index: -1"></div><div></div></div></div></div></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h3>Code for getting 150, 250, and 400 base pair "read" indices from the previously calculated primer indices.
There will be some duplicates, such as the forward 150 reads from v2 and v2.v3 regions.  We manually deleted the duplicates for our demo.</h3></div></div><div class="cell border-box-sizing code_cell vbox" tabindex="2"><div class="input hbox"><div class="prompt input_prompt">In&nbsp;[8]:</div><div class="input_area box-flex1"><div class="CodeMirror"><div style="overflow-x: hidden; overflow-y: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 5px; "><textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-ipython" tabindex="-1"><div style="position: relative; height: 1370px; "><div style="position: relative; top: 0px; "><div class="CodeMirror-gutter" style="display: none; "><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0; outline-style: none; outline-width: initial; outline-color: initial; "><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden; outline: 5px auto none"></div><pre class="CodeMirror-cursor" style="top: 0px; left: 0px; ">&nbsp;</pre><div style="position: relative; z-index: -1; display: none; "></div><div style=""><pre><span class="cm-comment"># Need to manually add the full length read, ('full.length', 0, 7682), which covers the entire Greengenes alignment.</span></pre><pre> </pre><pre><span class="cm-variable">region_boundaries</span> = [</pre><pre>      (<span class="cm-string">'v2'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'27f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'338r'</span>]),</pre><pre>      (<span class="cm-string">'v2.v3'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'27f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'534r'</span>]),</pre><pre>      (<span class="cm-string">'v2.v4'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'27f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'806r'</span>]),</pre><pre>      (<span class="cm-string">'v2.v6'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'27f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1048r'</span>]),</pre><pre>      (<span class="cm-string">'v2.v8'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'27f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1391r'</span>]),</pre><pre>      (<span class="cm-string">'v2.v9'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'27f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1492r'</span>]),</pre><pre>      (<span class="cm-string">'v3'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'349f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'534r'</span>]),</pre><pre>      (<span class="cm-string">'v3.v4'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'349f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'806r'</span>]),</pre><pre>      (<span class="cm-string">'v3.v6'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'349f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1048r'</span>]),</pre><pre>      (<span class="cm-string">'v3.v8'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'349f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1391r'</span>]),</pre><pre>      (<span class="cm-string">'v3.v9'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'349f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1492r'</span>]),</pre><pre>      (<span class="cm-string">'v4'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'515f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'806r'</span>]),</pre><pre>      (<span class="cm-string">'v4.v6'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'515f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1048r'</span>]),</pre><pre>      (<span class="cm-string">'v4.v8'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'515f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1391r'</span>]),</pre><pre>      (<span class="cm-string">'v4.v9'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'515f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1492r'</span>]),</pre><pre>      (<span class="cm-string">'v6'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'967f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1048r'</span>]),</pre><pre>      (<span class="cm-string">'v6.v8'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'967f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1391r'</span>]),</pre><pre>      (<span class="cm-string">'v6.v9'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'967f'</span>], <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1492r'</span>]),</pre><pre>      (<span class="cm-string">'v9'</span>, <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1391f'</span>],  <span class="cm-variable">primer_indices</span>[<span class="cm-string">'1492r'</span>])</pre><pre>]</pre><pre> </pre><pre><span class="cm-variable">region_index</span> = <span class="cm-number">0</span></pre><pre><span class="cm-variable">start_index</span> = <span class="cm-number">1</span></pre><pre><span class="cm-variable">end_index</span> = <span class="cm-number">2</span></pre><pre> </pre><pre><span class="cm-comment"># Print in easy format to generate a list</span></pre><pre><span class="cm-keyword">for</span> <span class="cm-variable">curr_region</span> <span class="cm-operator">in</span> <span class="cm-variable">region_boundaries</span>:</pre><pre>    <span class="cm-keyword">print</span> <span class="cm-string">"('%s', %d, %d),"</span> <span class="cm-operator">%</span> (<span class="cm-variable">curr_region</span>[<span class="cm-variable">region_index</span>], <span class="cm-variable">curr_region</span>[<span class="cm-variable">start_index</span>], <span class="cm-variable">curr_region</span>[<span class="cm-variable">end_index</span>])</pre><pre>    </pre><pre><span class="cm-comment"># Manually print full length alignment</span></pre><pre><span class="cm-keyword">print</span> <span class="cm-string">"('full.length', 0, 7682),"</span></pre><pre> </pre><pre><span class="cm-variable">ix_sizes</span> = [<span class="cm-number">150</span>, <span class="cm-number">250</span>, <span class="cm-number">400</span>]</pre><pre> </pre><pre><span class="cm-variable">names_ix</span> = [<span class="cm-string">'.150'</span>, <span class="cm-string">'.250'</span>, <span class="cm-string">'.400'</span>]</pre><pre> </pre><pre><span class="cm-comment"># We used the first sequence in the 97% clustered file for the demonstration, so using the</span></pre><pre><span class="cm-comment"># same file here to recreate exact results</span></pre><pre><span class="cm-variable">reference97_aligned_file</span> = <span class="cm-string">'/software/gg_otus-4feb2011-release/rep_set/gg_97_otus_4feb2011_aligned.fasta'</span></pre><pre> </pre><pre><span class="cm-variable">f</span> = <span class="cm-builtin">open</span>(<span class="cm-variable">reference97_aligned_file</span>, <span class="cm-string">"U"</span>)</pre><pre> </pre><pre><span class="cm-keyword">for</span> <span class="cm-variable">label</span>, <span class="cm-variable">seq</span> <span class="cm-operator">in</span> <span class="cm-variable">MinimalFastaParser</span>(<span class="cm-variable">f</span>):</pre><pre>    <span class="cm-variable">curr_seq</span> = <span class="cm-variable">seq</span></pre><pre>    <span class="cm-keyword">break</span></pre><pre>    </pre><pre><span class="cm-variable">f.close</span>()</pre><pre> </pre><pre><span class="cm-variable">nts</span> = [<span class="cm-string">'A'</span>, <span class="cm-string">'T'</span>, <span class="cm-string">'C'</span>, <span class="cm-string">'G'</span>, <span class="cm-string">'N'</span>]</pre><pre> </pre><pre> </pre><pre><span class="cm-keyword">for</span> <span class="cm-variable">curr_region</span> <span class="cm-operator">in</span> <span class="cm-variable">region_boundaries</span>:</pre><pre> </pre><pre>    <span class="cm-keyword">for</span> <span class="cm-variable">forward_ix</span> <span class="cm-operator">in</span> <span class="cm-builtin">range</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">ix_sizes</span>)):</pre><pre>        <span class="cm-variable">curr_name</span> = <span class="cm-variable">curr_region</span>[<span class="cm-variable">region_index</span>]</pre><pre>        <span class="cm-variable">curr_name</span> += <span class="cm-variable">names_ix</span>[<span class="cm-variable">forward_ix</span>]</pre><pre>        </pre><pre>        <span class="cm-variable">start_ix</span> = <span class="cm-variable">curr_region</span>[<span class="cm-variable">start_index</span>]</pre><pre>        <span class="cm-variable">end_ix</span> = <span class="cm-variable">curr_region</span>[<span class="cm-variable">end_index</span>]</pre><pre> </pre><pre>        <span class="cm-variable">curr_slice</span> = <span class="cm-variable">curr_seq</span>[<span class="cm-variable">start_ix</span>:<span class="cm-variable">end_ix</span>]</pre><pre> </pre><pre>        </pre><pre>        <span class="cm-variable">counter</span> = <span class="cm-number">0</span></pre><pre>        <span class="cm-variable">target_count</span> = <span class="cm-variable">ix_sizes</span>[<span class="cm-variable">forward_ix</span>]</pre><pre>        </pre><pre>        <span class="cm-variable">curr_forward_ix</span> = <span class="cm-variable">start_ix</span></pre><pre>        <span class="cm-keyword">for</span> <span class="cm-variable">nt</span> <span class="cm-operator">in</span> <span class="cm-variable">curr_slice</span>:</pre><pre>            <span class="cm-keyword">if</span> <span class="cm-variable">nt</span> <span class="cm-operator">in</span> <span class="cm-variable">nts</span>:</pre><pre>                <span class="cm-variable">counter</span> += <span class="cm-number">1</span></pre><pre>            <span class="cm-variable">curr_forward_ix</span> += <span class="cm-number">1</span></pre><pre>            <span class="cm-comment"># Skip if amplicon is smaller than current read size</span></pre><pre>            <span class="cm-keyword">if</span> <span class="cm-variable">curr_forward_ix</span> <span class="cm-operator">==</span> <span class="cm-variable">end_ix</span>:</pre><pre>                <span class="cm-keyword">break</span></pre><pre>            <span class="cm-keyword">if</span> <span class="cm-variable">counter</span> <span class="cm-operator">==</span> <span class="cm-variable">target_count</span>:</pre><pre>                <span class="cm-keyword">print</span> <span class="cm-string">"('%s', %d, %d),"</span> <span class="cm-operator">%</span> (<span class="cm-variable">curr_name</span>, <span class="cm-variable">start_ix</span>, <span class="cm-variable">curr_forward_ix</span>)</pre><pre>                <span class="cm-keyword">break</span> </pre></div></div></div></div></div></div></div></div></div><div class="output vbox" style=""></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="text_cell_input border-box-sizing" style="display: none; "><div class="CodeMirror CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-default" tabindex="-1"><div style="position: relative"><div style="position: relative"><div class="CodeMirror-gutter" style="display: none; "><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0; outline-style: none; outline-width: initial; outline-color: initial; "><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden; outline: 5px auto none"><pre><span>x</span></pre></div><pre class="CodeMirror-cursor">&nbsp;</pre><div style="position: relative; z-index: -1"></div><div></div></div></div></div></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h3>Example output and curation for final list of indices</h3></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="text_cell_input border-box-sizing"><div class="CodeMirror CodeMirror-wrap"><div style="overflow-x: hidden; overflow-y: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 5px; "><textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-default" tabindex="-1"><div style="position: relative; height: 2305px; "><div style="position: relative; top: 0px; "><div class="CodeMirror-gutter" style="display: none; "><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0; outline-style: none; outline-width: initial; outline-color: initial; "><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden; outline: 5px auto none"></div><pre class="CodeMirror-cursor" style="top: 0px; left: 0px; ">&nbsp;</pre><div style="position: relative; z-index: -1; display: none; "></div><div style=""><pre>Here is the raw output of the previous steps that can be easily put into the list base_region_boundaries in the main notebook:</pre><pre>('v2', 136, 1868),</pre><pre>('v2.v3', 136, 2232),</pre><pre>('v2.v4', 136, 4051),</pre><pre>('v2.v6', 136, 4932),</pre><pre>('v2.v8', 136, 6426),</pre><pre>('v2.v9', 136, 6791),</pre><pre>('v3', 1916, 2232),</pre><pre>('v3.v4', 1916, 4051),</pre><pre>('v3.v6', 1916, 4932),</pre><pre>('v3.v8', 1916, 6426),</pre><pre>('v3.v9', 1916, 6791),</pre><pre>('v4', 2263, 4051),</pre><pre>('v4.v6', 2263, 4932),</pre><pre>('v4.v8', 2263, 6426),</pre><pre>('v4.v9', 2263, 6791),</pre><pre>('v6', 4653, 4932),</pre><pre>('v6.v8', 4653, 6426),</pre><pre>('v6.v9', 4653, 6791),</pre><pre>('v9', 6450, 6791),</pre><pre>('full.length', 0, 7682),</pre><pre>('v2.150', 136, 702),</pre><pre>('v2.250', 136, 1752),</pre><pre>('v2.v3.150', 136, 702),</pre><pre>('v2.v3.250', 136, 1752),</pre><pre>('v2.v3.400', 136, 2036),</pre><pre>('v2.v4.150', 136, 702),</pre><pre>('v2.v4.250', 136, 1752),</pre><pre>('v2.v4.400', 136, 2036),</pre><pre>('v2.v6.150', 136, 702),</pre><pre>('v2.v6.250', 136, 1752),</pre><pre>('v2.v6.400', 136, 2036),</pre><pre>('v2.v8.150', 136, 702),</pre><pre>('v2.v8.250', 136, 1752),</pre><pre>('v2.v8.400', 136, 2036),</pre><pre>('v2.v9.150', 136, 702),</pre><pre>('v2.v9.250', 136, 1752),</pre><pre>('v2.v9.400', 136, 2036),</pre><pre>('v3.v4.150', 1916, 2235),</pre><pre>('v3.v4.250', 1916, 2493),</pre><pre>('v3.v4.400', 1916, 4014),</pre><pre>('v3.v6.150', 1916, 2235),</pre><pre>('v3.v6.250', 1916, 2493),</pre><pre>('v3.v6.400', 1916, 4014),</pre><pre>('v3.v8.150', 1916, 2235),</pre><pre>('v3.v8.250', 1916, 2493),</pre><pre>('v3.v8.400', 1916, 4014),</pre><pre>('v3.v9.150', 1916, 2235),</pre><pre>('v3.v9.250', 1916, 2493),</pre><pre>('v3.v9.400', 1916, 4014),</pre><pre>('v4.150', 2263, 3794),</pre><pre>('v4.250', 2263, 4046),</pre><pre>('v4.v6.150', 2263, 3794),</pre><pre>('v4.v6.250', 2263, 4046),</pre><pre>('v4.v6.400', 2263, 4574),</pre><pre>('v4.v8.150', 2263, 3794),</pre><pre>('v4.v8.250', 2263, 4046),</pre><pre>('v4.v8.400', 2263, 4574),</pre><pre>('v4.v9.150', 2263, 3794),</pre><pre>('v4.v9.250', 2263, 4046),</pre><pre>('v4.v9.400', 2263, 4574),</pre><pre>('v6.v8.150', 4653, 5085),</pre><pre>('v6.v8.250', 4653, 5903),</pre><pre>('v6.v8.400', 4653, 6419),</pre><pre>('v6.v9.150', 4653, 5085),</pre><pre>('v6.v9.250', 4653, 5903),</pre><pre>('v6.v9.400', 4653, 6419),</pre><pre> </pre><pre>But there are some duplicate regions here, such as v2.150 and v2.v3.150. These can be manually removed to get this:</pre><pre>('v2', 136, 1868),</pre><pre>('v2.v3', 136, 2232),</pre><pre>('v2.v4', 136, 4051),</pre><pre>('v2.v6', 136, 4932),</pre><pre>('v2.v8', 136, 6426),</pre><pre>('v2.v9', 136, 6791),</pre><pre>('v3', 1916, 2232),</pre><pre>('v3.v4', 1916, 4051),</pre><pre>('v3.v6', 1916, 4932),</pre><pre>('v3.v8', 1916, 6426),</pre><pre>('v3.v9', 1916, 6791),</pre><pre>('v4', 2263, 4051),</pre><pre>('v4.v6', 2263, 4932),</pre><pre>('v4.v8', 2263, 6426),</pre><pre>('v4.v9', 2263, 6791),</pre><pre>('v6', 4653, 4932),</pre><pre>('v6.v8', 4653, 6426),</pre><pre>('v6.v9', 4653, 6791),</pre><pre>('v9', 6450, 6791),</pre><pre>('full.length', 0, 7682),</pre><pre>('v2.150', 136, 702),</pre><pre>('v2.250', 136, 1752),</pre><pre>('v2.v3.400', 136, 2036),</pre><pre>('v3.v4.150', 1916, 2235),</pre><pre>('v3.v4.250', 1916, 2493),</pre><pre>('v3.v4.400', 1916, 4014),</pre><pre>('v4.150', 2263, 3794),</pre><pre>('v4.250', 2263, 4046),</pre><pre>('v4.v6.400', 2263, 4574),</pre><pre>('v6.v8.150', 4653, 5085),</pre><pre>('v6.v8.250', 4653, 5903),</pre><pre>('v6.v8.400', 4653, 6419)</pre><pre> </pre><pre>Which is the same subset of sequences used to define base_region_boundaries (copied from the main demonstration notebook):</pre><pre>      ('v2', 136, 1868), #27f-338r</pre><pre>      ('v2.v3', 136, 2232),</pre><pre>      ('v2.v4', 136, 4051),</pre><pre>      ('v2.v6', 136, 4932),</pre><pre>      ('v2.v8', 136, 6426),</pre><pre>      ('v2.v9', 136, 6791),</pre><pre>      ('v3', 1916, 2232), #349f-534r</pre><pre>      ('v3.v4', 1916, 4051),</pre><pre>      ('v3.v6', 1916, 4932),</pre><pre>      ('v3.v8', 1916, 6426),</pre><pre>      ('v3.v9', 1916, 6791),</pre><pre>      ('v4', 2263, 4051), #515f-806r</pre><pre>      ('v4.v6', 2263, 4932),</pre><pre>      ('v4.v8', 2263, 6426),</pre><pre>      ('v4.v9', 2263, 6791),</pre><pre>      ('v6', 4653, 4932), #967f-1048r</pre><pre>      ('v6.v8', 4653, 6426),</pre><pre>      ('v6.v9', 4653, 6791),</pre><pre>      ('v9', 6450, 6791), #1391f-1492r</pre><pre>      ('full.length', 0, 7682),  # Start 150, 250, 400 base pair reads</pre><pre>      ('v2.150', 136, 702),</pre><pre>      ('v2.250', 136, 1752),</pre><pre>      ('v2.v3.400', 136, 2036), # Skips reads that are larger than amplicon size</pre><pre>      ('v3.v4.150', 1916, 2235),</pre><pre>      ('v3.v4.250', 1916, 2493),</pre><pre>      ('v3.v4.400', 1916, 4014),</pre><pre>      ('v4.150', 2263, 3794),</pre><pre>      ('v4.250', 2263, 4046),</pre><pre>      ('v4.v6.400', 2263, 4574),</pre><pre>      ('v6.v8.150', 4653, 5085),</pre><pre>      ('v6.v8.250', 4653, 5903),</pre><pre>      ('v6.v8.400', 4653, 6419)</pre></div></div></div></div></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1" style="display: none; "></div></div><div class="end_space" style="height: 30%; "></div></div>
</div>
</div>

</div>
<script src="./VariableRegionPositionBoundaries_files/jquery-1.7.1.min.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/jquery-ui.min.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/namespace.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/page.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/loginwidget.js" type="text/javascript" charset="utf-8"></script>

<script src="./VariableRegionPositionBoundaries_files/codemirror.js" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/python.js" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/htmlmixed.js" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/xml.js" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/javascript.js" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/css.js" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/rst.js" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/markdown.js" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/Markdown.Converter.js" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/prettify.js" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/date.format.js" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/events.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/utils.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/initmathjax.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/cell.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/codecell.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/textcell.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/kernel.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/notebook.js" type="text/javascript" charset="utf-8"></script>
<script src="./VariableRegionPositionBoundaries_files/printnotebookmain.js" type="text/javascript" charset="utf-8"></script>



</body></html>